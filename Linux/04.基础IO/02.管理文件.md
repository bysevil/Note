## 磁盘结构和其物理结构

硬盘通过一个个盘片存储数据，每个圆形圈道称作磁道，每个区域称作扇面。找数据时，只需要知道在那个盘片，哪个磁道，拿书扇面就能找到数据，这是CHS地址。

而在逻辑结构上，将每个盘片当作一个分区，每个磁道认为是一个数组，每个扇区是一个数组元素（快组）。通过这种形式寻找数据，这是LBA地址。

将LBA转换为CHS地址，就能在磁盘上找到数据。

磁盘的基本单位是扇区（512KB），但是操作系统和磁盘IO的基本单位是4KB。

## 块组的内容

每个块组都包含下列数据块：
- super block ： 整个文件系统的属性信息，备份在多个块组中
- data blocks： 多个4kb大小的块的集合，保存文件的内容
- inode table：inode是一个128字节的空间，保存对应文件的属性，inode table保存所有文件的inode。通过inode编号在inode table中可以找到指定文件的inode。通过inode可以找到属于文件的block或者blocks（通过一个数组，这个数组内存入所有属于这个inode的block）。
- blockbitmap：位图，一一对应每个4kb的block是否被占用。
- inodebitmap：位图：一一对应每个inode编号是否被占用。
- Group Descriptor Table ：块组描述符，有多少inode和block，被占用了多少。

>如果一个文件的数据太大，需要在多个块组存储，可以在块组的block内存其他块的块号，用来表示别的块组内也有这个文件的数据。

inode编号只是一串数字，对于人类来说，使用目录+文件名来查找文件，而不是inode。

目录本身也是文件，有inode和block，这个目录下的所有文件的文件名和其inode被存于目录的block中。
## 软硬链接

使用in命令可以建立链接
```C
in -s 源 链接名
in 源 链接名
```

默认是硬链接，使用-s可以建立软连接。软连接有独立的inode，硬链接没有。

软链接相当于window下的快捷方式，创建一个新文件，文件内存入源的文件路径。

硬链接没有创建新文件，只是在目录下创建了一个新的 文件名--inode 的关联关系，相当于给源起别名。

在inode里有一个引用计数，说明有多少文件名指向这个inode，当这个计数为0时，表示文件被删除。

> 创建文件时，默认的引用计数时1。创建目录时，默认是引用计数是2，因为创建目录的时候，因为目录里面有一个硬链接`.`指向目录自己。当创建子目录时，父目录的引用计数会加1，因为子目录有一个硬链接`..`指向父目录。



