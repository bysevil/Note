## 分支

git提供了分支功能来管理一个仓库的不同的方向。我们可以在一个分支上写这种功能，又在另一个分支上写另一种功能。

不同分支间版本不同步，各自进行各自的更新。

git鼓励你使用分支完成某个任务，然后合并回主分支再删除分支，这和直接在master分支上工作效果是一样的，但过程更加安全。

创建，合并，删除分支是非常快的。

在默认情况下，我们的提交将会提交到master分支，这个分支在仓库初始化时被创建。

### 获取仓库的分支情况

```shell
git branch
```

### 创建新分支

```shell
git branch 分支名
```

### 改变当前的工作分支

```shell
git checkout 分支名
```

> HEAD指向的分支，就是当前工作的分支

### 创建并使当前工作分支改变为新分支

```shell
git checkout -b 分支名
```

这时候你的提交将会提交到指定的分支，如果要在之前的分支进行提交，要先切回之前的分支。

### 删除和强制删除分支

```shell
git branch -d 分支名
```

> 你不能删除当前的工作分支

如果这个分支上已经有提交且最新的提交未合并到其他分支，普通删除无法删除分支，你需要强制删除。

```shell
git beanch -D 分支名 
```

## 合并分支

可以将多条分支进行合并

```shell
git merge 另一个分支名
```

> 相当于直接将当前分支的最新的commit ID改变为另一个分支最新的commit ID。
>
> 相当于在当前工作分支进行了一次提交，提交内容为另一个分支最新版本的内容。
>
> 这种合并方式可能会造成隐患，因为两个分支的文件可能会出现冲突

### 处理冲突

再合并分支时，同一个文件再不同的分支上可能有不同的内容。这称作合并冲突。

在分支合并后，有冲突的文件将会被git改变

```shell
不冲突的内容
<<<<<<<<< HEAD
冲突内容在当前分支上的版本
============
冲突内容在被合并分支上的版本
>>>>>>>> 被合并的分支名
不冲突的内容
```

这时候我们只需要对文件进行修改，选择自己要保留的内容，删掉不需要的内容即可。

在处理完冲突后，对文件进行一次提交。

### 合并模式

在Git中，合并分支时有两种模式：Fast-Forward（FF）模式和No-Fast-Forward（No-FF）模式。

1. Fast-Forward（FF）模式：

   - 当你在合并分支时，如果被合并的分支的所有提交都是基于当前分支最新提交之上的，Git会执行快进合并（Fast-Forward Merge）。
   - 在快进合并中，Git会简单地将当前分支指针直接移动到被合并分支的最新提交，这样就完成了合并。
   - 快进合并不会产生额外的合并提交，因为历史记录是线性的。
2. No-Fast-Forward（No-FF）模式：

   - 当被合并的分支的提交历史不是直接基于当前分支的最新提交时，Git会执行非快进合并（No-Fast-Forward Merge）。
   - 在非快进合并中，Git会创建一个新的合并提交，将被合并分支和当前分支的历史记录合并在一起。
   - 这样会保留被合并分支的历史记录，并且在提交历史中可以清晰地看到分支的合并点。

通常情况下，快进合并会保持提交历史的简洁和清晰，因为它不会创建额外的合并提交。而非快进合并则可以更清晰地展示分支的合并点和历史记录。你可以根据实际情况和团队的合并策略来选择合适的合并模式。

你可以强制使用no-ff模式，因为no-ff模式会创建一次新的提交，所以需要提供消息；

```shelll
git merge --no-ff -m "消息" 分支名
```

> 推荐使用no-ff模式，有更详细的分支信息。

### 合并策略

一般来说，我们必须保证master分支上的所有提交都是稳定的。

我们可以创建dev分支来修改代码，待到测试后保证稳定然后合并到master分支。

如果master分支有隐藏的bug，也要创建新的dev分支去修改，在确认bug解决且没有创造新的bug时再提交到master分支。

## 储存工作区

假设有这样一种情况，你使用master分支发行稳定版的代码，再dev分支上进行开发。此时，你发现master分支上有一个bug。

这时候正确的做法应该是使用stash命令进行保存

```shell
git stash
```

> 保存的意义在于，你想要回去修改master的bug，但是在工作区中dev已经进行了部分开发，如果转换当前工作分支未master，并且修复bug并提交，那么为dev分支所做的工作也被提交到master上，因为dev是未开发完且未确定稳定性的代码，这会有极大的隐患
>
> 而在使用stash命令后，在dev所做的修改将会被保存在stash中，这时候你切回master分支，将会发现工作区中的代码回到了master的最后一次提交

使用stash命令的分支将无法追踪文件的改动，直到解除。解除后，工作区会回到stash时的状态。此时可以继续开发。

```shell
git stash pop
```

> 因为stash的缘故，master中的bug已经被修复，而dev的bug还没有被解决。此时用dev去合并master，如果有隐患，也会在dev分支上解决，直到确认代码稳定性，再用master去合并dev。这能保证master的内容始终是最稳定的。

## 强制删除分支
