# 版本回退

本质回退的是版本库的内容

### 回退到指定版本

```shell
git  reset [--soft | --mixed | --hard] [commit ID]
```

- soft 只回退版本库的内容
- mixed 回退版本库和暂存区的内容
- hard 回退所有区域的内容

> - 默认使用mixed
> - 慎用hard

#### 按版本回退

可以只回退到当前版本，也就是将上次提交后对工作区和暂存区的修改全部取消

```shell
git reset HEAD
```

可以按版本回退

```shell
git reset HEAD^
git rest HEAD^^
```

一个 `^`表示回退一个版本，两个 `^^`表示回退两个版本，以此类推

#### 只回退指定文件

```shell
git reset HEAD 文件名
```

#### 撤销回退

版本回退之后，我们使用 `git log`只能查看回退到的那个版本之前的版本的信息

如果我们又要回到最新的版本，首先我们要查看最新版本的 `commit ID`

```shell
git reflog
```

> reflog会记录每次提交的命令和 `commit ID`包括被回退版本的

这时候我们只需要通过最新版的 `commit ID`再次回退即可

## 撤销修改

| 工作区   | 暂存区   | 版本库   | 解决方案                                           |                                              |
| -------- | -------- | -------- | -------------------------------------------------- | -------------------------------------------- |
| 发生修改 | 未添加   | 未提交   | 1.手动撤销（不推荐）<br />2.git checkout -- 文件名 | 将工作区的指定文件退回到最新一次提交的状态   |
| 发生修改 | 进行添加 | 未提交   | git reset HEAD 文件名                              | 将工作区和暂存区的指定文件回退到最新一次提交 |
| 发生修改 | 进行添加 | 进行提交 | git reset --hard HEAD 文件名                       | 将仓库的指定文件回退到最新一次提交           |

> - 如果已经推送到远程仓库，则无法通过此方法撤销，这个撤销只能撤销本地
> - 撤销的目的就是使本地的错误代码不影响远程仓库
